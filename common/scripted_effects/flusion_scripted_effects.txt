pki_create_flusion_nations = {

	## SPECIES

	event_target:pki_flusion_planet = {
		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = ATA
			CLASS = MAM
			PORTRAIT = rep5
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_traditional
				trait = trait_intelligent
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = CYA
			CLASS = MAM
			PORTRAIT = mam14
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_strong
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = DTC
			CLASS = HUM
			PORTRAIT = humanoid_03
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_strong
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = HAR
			CLASS = HUM
			PORTRAIT = humanoid_05
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_intelligent
				trait = trait_decadent
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = GTA
			CLASS = FUN
			PORTRAIT = fun1
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_delicious
				trait = trait_erudite
				trait = trait_wasteful
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = KRO
			CLASS = ART
			PORTRAIT = art15
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_industrious
				trait = trait_rapid_breeders
				trait = trait_sedentary
				trait = trait_repugnant
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = MER
			CLASS = PLANT
			PORTRAIT = pla14
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_intelligent
				trait = trait_sedentary
				trait = trait_wasteful
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = LAU
			CLASS = REP
			PORTRAIT = rep8
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_rapid_breeders
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = LIN
			CLASS = AVI
			PORTRAIT = avi11
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_talented
				trait = trait_traditional
				trait = trait_decadent
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = PFL
			CLASS = FUN
			PORTRAIT = fun11
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_strong
				trait = trait_nomadic
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = RAV
			CLASS = HUM
			PORTRAIT = humanoid_hp_01
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_intelligent
				trait = trait_sedentary
				trait = trait_wasteful
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = ROQ
			CLASS = HUM
			PORTRAIT = human
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_intelligent
				trait = trait_charismatic
				trait = trait_resilient
				trait = trait_wasteful
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = YIN
			CLASS = HUM
			PORTRAIT = humanoid_hp_09
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_industrious
				trait = trait_sedentary
			"
		}

		inline_script = {
			script = pki/pki_country_species_creation
			COUNTRY = ZUS
			CLASS = REP
			PORTRAIT = rep10
			TRAITS = "
				trait = trait_pc_continental_preference
				trait = trait_venerable
				trait = trait_adaptive
				trait = trait_strong
				trait = trait_slow_learners
				trait = trait_quarrelsome
				trait = trait_slow_breeders
			"
		}
	}

	#Create Flusion Nations

	inline_script = {
		script = pki/pki_inline_script
		SCRIPT_NAME = country_creation
	}

	event_target:pki_ATA_country = {
		change_government = {
			authority = auth_democratic
		}
		country_add_ethic = ethic_xenophile
		country_add_ethic = ethic_spiritualist
		country_add_ethic = ethic_pacifist
		change_country_flag = {
			icon = {
				category = "spherical"
				file = "flag_spherical_9.dds"
			}
			background = {
				category = "backgrounds"
				file = "diagonal.dds"
			}
			colors = {
				intense_blue
				mist_blue
			}
		}
		room_name_override = ""
	}
}

create_meowrines = {
	if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_befreier } } }
		create_fleet = {
			name = "Legion Befreier"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_befreier
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_purrgund } } }
		create_fleet = {
			name = "Reichslegion Purrgund"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_purrgund
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_kattail } } }
		create_fleet = {
			name = "Reichslegion Kattail"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_kattail
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_gloria } } }
		create_fleet = {
			name = "Reichslegion Gloria"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_gloria
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_zerstorer } } }
		create_fleet = {
			name = "Legion Zerstörer"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_zerstorer
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_verteidiger } } }
		create_fleet = {
			name = "Legion Verteidiger"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_verteidiger
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_kettenbrecher } } }
		create_fleet = {
			name = "Legion Kettenbrecher"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_kettenbrecher
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_unserblich } } } #misspelled but that's how they were named originally so I won't change it
		create_fleet = {
			name = "Legion Unserblich"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_unserblich
		}
	}
	else_if = {
		limit = { planet_owner = { NOT = { has_country_flag = recruited_wachter } } }
		create_fleet = {
			name = "Legion Wächter"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
		planet.owner = {
			set_country_flag = recruited_wachter
		}
	}
	else = {
		create_fleet = {
			name = "Meowrine Legion"
			effect = {
				set_owner = prev.owner
				while = {
					count = 8
					create_army_transport = {
						army_type = meowrine_company
					}
				}
				set_location = {
					target = root
				}
			}
		}
	}
}

pki_increase_used_factories = {
	if = {
		limit = {
			has_country_flag = pki_used_all_building_slots
		}
		set_variable = {
			which = pki_used_industry
			value = 0
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = pki_map_industry_select_mult
				value >= value:pki_job_industry_factories
			}
		}
		set_variable = {
			which = pki_used_industry
			value = value:pki_total_industry
		}
	}
	else = {
		change_variable = {
			which = pki_used_industry
			value = pki_map_industry_select_mult
		}
	}
}

pki_decrease_used_factories = {
	set_variable = {
		which = pki_negative_factories_check
		value = value:pki_used_factories_check }
	if = {
		limit = {
			check_variable = {
				which = pki_negative_factories_check
				value <= 0
			}
		}
		set_variable = {
			which = pki_used_industry
			value = 0
		}
	}
	else = {
		subtract_variable = {
			which = pki_used_industry
			value = pki_map_industry_select_mult
		}
	}

	if = {
		limit = {
			has_country_flag = pki_used_all_building_slots
		}
		set_variable = {
			which = pki_used_industry
			value = 0
		}
	}
}