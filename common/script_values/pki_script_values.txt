flusion_empire_ratio = {
    add = trigger:num_pops
    divide = owner.capital_scope.trigger:num_pops
}

pki_flusion_half_threshold = {
    add = root.capital_scope.trigger:num_pops
    divide = 2
    floor = yes
    subtract = 5
}

pki_galaxy_systems = {
    complex_trigger_modifier = {
        trigger = count_system
        trigger_scope = system_star
        parameters = {
            limit = {
                giga_is_empty_space = no
            }
        }
        mode = add
    }
}

pki_galaxy_owned = {
    add = trigger:count_system_within_border
    divide = pki_num_galaxy_systems
    multiply = 100
}

pki_set_situation_progress_effect = {
    add = $NEW_PROGRESS$
    subtract = trigger:situation_progress
}

flusion_empire_ratio_five = {
    weight = value:flusion_empire_ratio
    subtract = 0.5
}

leader_katzenification_cost = {
    base = 20
    mult = trigger:empire_size
}

pki_num_warforges = {
    complex_trigger_modifier = {
        trigger = count_system_planet
        trigger_scope = solar_system
        parameters = {
            limit = { has_planet_flag = war_forge }
        }
        mode = add
    }
}

pki_num_total_warforges = {
    complex_trigger_modifier = {
        trigger = count_galaxy_planet
        trigger_scope = solar_system
        parameters = {
            limit = { has_planet_flag = war_forge }
        }
        mode = add
    }
}

pki_focus_time = {
    add = 1
    divide =  value:pki_focus_length
}

pki_focus_length = {
    add = event_target:pki_player.pki_focus_speed
}

pki_world_domination = {
    add = event_target:pki_flusion_planet.modifier:pki_industry_building_slots
    divide = 1.5
}

pki_world_domination_opposite = {
    add = 100
    subtract = value:pki_world_domination
    divide = 100
}

pki_total_industry = {
    base = 1
    mult = pki_industry_level
    floor = yes
}

pki_job_industry_factories = {
    base = 1
    mult = value:pki_total_industry
    subtract = pki_used_industry
}

pki_used_factories_check = {
    add = pki_used_industry
    subtract = pki_map_industry_select_mult
}

pki_industry_factories_in_progress = {
    add = pki_used_industry
    divide = 15
    floor = yes
}

pki_industry_factories_monthly_extra = {
    add = pki_used_industry
    divide = 16
    floor = yes
    multiply = 45
}

pki_industry_factories_monthly_progress = {
    add = pki_used_industry
    modulo = 16
    multiply = 5
    add = value:pki_industry_factories_monthly_extra
}

pki_industry_new_factories = {
    base = 1
    add = value:pki_industry_factories_in_progress
}

pki_industry_ai_used_num = {
    add = pki_industry_level
    multiply = pki_used_industry_ratio
    floor = yes
}

pki_industry_ai_availible_factories = {
    add = pki_industry_level
    subtract = value:pki_industry_ai_used_num
}

pki_industry_ai_army = {
    add = value:pki_industry_ai_availible_factories
    multiply = pki_army_ratio
}

pki_industry_ai_air = {
    add = value:pki_industry_ai_availible_factories
    multiply = pki_planes_ratio
}

inline_script = {
    script = pki/pki_random_intel
    CATEGORY = factory
    VARIABLE = pki_industrial_level
}

pki_num_armies = {
    complex_trigger_modifier = {
        trigger_scope = planet
        trigger = count_planet_army
        mode = add
        parameters = {
            limit = {
                pki_is_normal_army = yes
            }
        }
    }
}

pki_num_air_wings = {
    complex_trigger_modifier = {
        trigger_scope = planet
        trigger = count_planet_army
        mode = add
        parameters = {
            limit = {
                pki_is_air_wing = yes
            }
        }
    }
}

pki_air_supremacy_contribution = {
    add = pki_num_cas
    divide = 100
    add = 1
    multiply = pki_num_fighters
}

pki_air_supremacy = {
    add = event_target:pki_player.value:pki_air_supremacy_contribution
    divide = value:pki_air_supremacy_total
}

pki_air_supremacy_total = {
    add = event_target:pki_player.value:pki_air_supremacy_contribution
    add = event_target:pki_conquest_target.value:pki_air_supremacy_contribution
}

pki_attack_moon_upkeep = {
    base = 1
    add = modifier:shipsize_giga_massive_planet_upkeep
}

pki_army_special_forces_limit = {
    complex_trigger_modifier = {
        trigger_scope = planet_owner
        trigger = count_owned_pop
        mode = add
    }
    divide = 10
    add = 3
}

pki_army_tanks_limit = {
    add = modifier:pki_tanks_max_add
}